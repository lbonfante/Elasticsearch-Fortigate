#input {
#        file {
#                path => "/var/log/nginx/access.log"
#                type => "nginx-access"
#                sincedb_path => "/var/log/.nginxaccesssincedb"
#        }
#}
#input {
#        file {
#                path => "/var/log/nginx/error.log"
#                type => "nginx-error"
#                sincedb_path => "/var/log/.nginxerrorsincedb"
#        }
#}
# Change redis threads count to match the number of cpus of this node
input {
        redis {
                host => "127.0.0.1"
                data_type => "list"
                key => "logstash"
                codec => "json"
                threads => "1"
        }
}
input {
        tcp {
                type => "syslog"
                port => "514"
        }
}
input {
        udp {
                type => "syslog"
                port => "514"
        }
}
filter {
        if [type] == "syslog" {
                dns {
                        reverse => [ "host" ]
                        action => "replace"
                }
                mutate {
                        add_tag => [ "syslog" ]
                }
        }
}
filter {
        if [type] == "syslog" {
                mutate {
                        remove_tag => "Ready"
                }
        }
}
# First layer of normal syslog parsing
filter {
        if "syslog" in [tags] {
                grok {
                        match => { "message" => [
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" appid=%{DATA:appid} user=\"%{WORD:user}\" group=\"%{DATA:group}\" srcip=%{IP:srcip} srcport=%{DATA:srcport} dstip=%{IP:dstip} dstport=%{DATA:dstport} proto=%{DATA:proto} service=\"%{DATA:service}\" sessionid=%{DATA:sessionid} applist=\"%{DATA:applist}\" appcat=\"%{DATA:appcat}\" app=\"%{DATA:app}\" action=%{DATA:action} hostname=\"%{DATA:hostname}\" url=\"%{DATA:url}\" msg=\"%{DATA:msg}\" apprisk=%{DATA:apprisk}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" appid=%{DATA:appid} user=\"%{WORD:user}\" srcip=%{IP:srcip} srcport=%{DATA:srcport} dstip=%{IP:dstip} dstport=%{DATA:dstport} proto=%{DATA:proto} service=\"%{DATA:service}\" sessionid=%{DATA:sessionid} applist=\"%{DATA:applist}\" appcat=\"%{DATA:appcat}\" app=\"%{DATA:app}\" action=%{DATA:action} hostname=\"%{DATA:hostname}\" url=\"%{DATA:url}\" msg=\"%{DATA:msg}\" apprisk=%{DATA:apprisk}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" appid=%{DATA:appid} user=\"%{WORD:user}\" srcip=%{IP:srcip} srcport=%{DATA:srcport} dstip=%{IP:dstip} dstport=%{DATA:dstport} proto=%{DATA:proto} service=\"%{DATA:service}\" sessionid=%{DATA:sessionid} applist=\"%{DATA:applist}\" appcat=\"%{DATA:appcat}\" app=\"%{DATA:app}\" action=%{DATA:action} msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" appid=%{DATA:appid} srcip=%{IP:srcip} srcport=%{DATA:srcport} dstip=%{IP:dstip} dstport=%{DATA:dstport} proto=%{DATA:proto} service=\"%{DATA:service}\" sessionid=%{DATA:sessionid} applist=\"%{DATA:applist}\" appcat=\"%{DATA:appcat}\" app=\"%{DATA:app}\" action=%{DATA:action} hostname=\"%{DATA:hostname}\" url=\"%{DATA:url}\" msg=\"%{DATA:msg}\" apprisk=%{DATA:apprisk}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" appid=%{DATA:appid} srcip=%{IP:srcip} srcport=%{DATA:srcport} dstip=%{IP:dstip} dstport=%{DATA:dstport} proto=%{DATA:proto} service=\"%{DATA:service}\" sessionid=%{DATA:sessionid} applist=\"%{DATA:applist}\" appcat=\"%{DATA:appcat}\" app=\"%{DATA:app}\" action=%{DATA:action} url=\"%{DATA:url}\" msg=\"%{DATA:msg}\" apprisk=%{DATA:apprisk}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" appid=%{DATA:appid} srcip=%{IP:srcip} srcport=%{DATA:srcport} dstip=%{IP:dstip} dstport=%{DATA:dstport} proto=%{DATA:proto} service=\"%{DATA:service}\" sessionid=%{DATA:sessionid} applist=\"%{DATA:applist}\" appcat=\"%{DATA:appcat}\" app=\"%{DATA:app}\" action=%{DATA:action} msg=\"%{DATA:msg}\" apprisk=%{DATA:apprisk}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" appid=%{DATA:appid} srcip=%{IP:srcip} srcport=%{DATA:srcport} dstip=%{IP:dstip} dstport=%{DATA:dstport} proto=%{DATA:proto} service=\"%{DATA:service}\" sessionid=%{DATA:sessionid} applist=\"%{DATA:applist}\" appcat=\"%{DATA:appcat}\" app=\"%{DATA:app}\" action=%{DATA:action} msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" sessionid=%{DATA:sessionid} user=\"%{WORD:user}\" group=\"%{DATA:group}\" srcip=%{IP:srcip} srcport=%{DATA:srcport} dstip=%{IP:dstip} dstport=%{DATA:dstport} proto=%{DATA:proto} service=%{DATA:service} hostname=\"%{DATA:hostname}\" profile=\"%{DATA:profile}\" action=%{DATA:action} reqtype=%{DATA:reqtype} url=\"%{DATA:url}\" sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} direction=%{DATA:direction} msg=\"%{DATA:msg}\" method=%{DATA:method} cat=%{DATA:cat} catdesc=\"%{DATA:catdesc}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" sessionid=%{DATA:sessionid} srcip=%{IP:srcip} srcport=%{DATA:srcport} dstip=%{IP:dstip} dstport=%{DATA:dstport} proto=%{DATA:proto} service=%{DATA:service} profile=\"%{DATA:profile}\" action=%{DATA:action} from=\"%{DATA:from}\" to=\"%{DATA:to}\" recipient=\"%{DATA:recipient}\" sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} direction=%{DATA:direction} msg=\"%{DATA:msg}\" subject=\"%{DATA:subject}\" attachment=%{DATA:attachment}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" sessionid=%{DATA:sessionid} srcip=%{IP:srcip} srcport=%{DATA:srcport} dstip=%{IP:dstip} dstport=%{DATA:dstport} proto=%{DATA:proto} service=%{DATA:service} profile=\"%{DATA:profile}\" action=%{DATA:action} from=\"%{DATA:from}\" to=\"%{DATA:to}\" sender=\"%{DATA:sender}\" recipient=\"%{DATA:recipient}\" sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} direction=%{DATA:direction} msg=\"%{DATA:msg}\" attachment=%{DATA:attachment}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" msg=\"%{DATA:msg}\" action=%{DATA:action} service=%{DATA:service} sessionid=%{DATA:sessionid} srcip=%{IP:srcip} dstip=%{IP:dstip} srcport=%{DATA:srcport} dstport=%{DATA:dstport} proto=%{DATA:proto} direction=%{DATA:direction} filename=\"%{DATA:filename}\" quarskip=%{DATA:quarskip} url=\"%{DATA:url}\" profile=\"%{DATA:profile}\" agent=\"%{DATA:agent}\" analyticscksum=\"%{DATA:analyticscksum}\" analyticssubmit=%{DATA:analyticssubmit}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} eventtype=%{DATA:eventtype} level=%{WORD:level} vd=\"%{WORD:vd}\" severity=%{DATA:severity} srcip=%{IP:srcip} dstip=%{IP:dstip} sessionid=%{DATA:sessionid} action=%{DATA:action} proto=%{DATA:proto} service=%{DATA:service} attack=\"%{DATA:attack}\" srcport=%{DATA:srcport} dstport=%{DATA:dstport} attackid=%{DATA:attackid} profile=\"%{DATA:profile}\" ref=\"%{DATA:ref}\" incidentserialno=%{DATA:incidentserialno} msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" srcssid=\"%{DATA:srcssid}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" group=\"%{DATA:group}\" policyid=%{DATA:policyid} crscore=%{DATA:crscore} craction=%{DATA:craction}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" group=\"%{DATA:group}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} applist=\"%{DATA:applist}\" duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac} utmaction=%{DATA:utmaction} countweb=%{DATA:countweb}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" group=\"%{DATA:group}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} applist=\"%{DATA:applist}\" duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" group=\"%{DATA:group}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} appid=%{DATA:appid} app=\"%{DATA:app}\" appcat=\"%{DATA:appcat}\" apprisk=%{DATA:apprisk} applist=\"%{DATA:applist}\" appact=%{DATA:appact} duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac} utmaction=%{DATA:utmaction} countweb=%{DATA:countweb} countapp=%{DATA:countapp}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" group=\"%{DATA:group}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} appid=%{DATA:appid} app=\"%{DATA:app}\" appcat=\"%{DATA:appcat}\" apprisk=%{DATA:apprisk} applist=\"%{DATA:applist}\" appact=%{DATA:appact} duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac} utmaction=%{DATA:utmaction} countapp=%{DATA:countapp}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" group=\"%{DATA:group}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} appid=%{DATA:appid} app=\"%{DATA:app}\" appcat=\"%{DATA:appcat}\" apprisk=%{DATA:apprisk} applist=\"%{DATA:applist}\" appact=%{DATA:appact} duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" group=\"%{DATA:group}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} appid=%{DATA:appid} app=\"%{DATA:app}\" appcat=\"%{DATA:appcat}\" apprisk=%{DATA:apprisk} applist=\"%{DATA:applist}\" appact=%{DATA:appact} duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac} utmaction=%{DATA:utmaction} countapp=%{DATA:countapp} crscore=%{DATA:crscore} craction=%{DATA:craction}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" group=\"%{DATA:group}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac} crscore=%{DATA:crscore} craction=%{DATA:craction}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" group=\"%{DATA:group}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} applist=\"%{DATA:applist}\" duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac} crscore=%{DATA:crscore} craction=%{DATA:craction}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" poluuid=%{DATA:poluuid} sessionid=%{DATA:sessionid} action=%{DATA:action} policyid=%{DATA:policyid} dstcountry=\"%{DATA:dstcountry}\" srccountry=\"%{DATA:srccountry}\" trandisp=%{DATA:trandisp} transip=%{DATA:transip} transport=%{DATA:transport} service=\"%{DATA:service}\" proto=%{DATA:proto} duration=%{DATA:duration} sentbyte=%{NUMBER:numsentbyte:int} rcvdbyte=%{NUMBER:numrcvdbyte:int} sentpkt=%{NUMBER:numsentpkt:int} rcvdpkt=%{NUMBER:numrcvdpkt:int} devtype=\"%{DATA:devtype}\" osname=\"%{DATA:osname}\" mastersrcmac=%{DATA:mastersrcmac} srcmac=%{DATA:srcmac}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" ssid=\"%{DATA:ssid}\" bssid=%{DATA:bssid} aptype=%{DATA:aptype} rate=%{DATA:rate} radioband=%{DATA:radioband} channel=%{DATA:channel} action=\"%{DATA:action}\" manuf=\"%{DATA:manuf}\" securitymode=\"%{DATA:securitymode}\" signal=%{DATA:signal} noise=%{DATA:noise} live=%{DATA:live} age=%{DATA:age} onwire=%{DATA:onwire} detectionmethod=\"%{DATA:detectionmethod}\" stamac=%{DATA:stamac} apscan=\"%{DATA:apscan}\" sndetected=\"%{DATA:sndetected}\" radioiddetected=%{DATA:radioiddetected} stacount=%{DATA:stacount} snclosest=\"%{DATA:snclosest}\" radioidclosest=%{DATA:radioidclosest} apstatus=%{DATA:apstatus} msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" policyid=%{DATA:policyid} appid=%{DATA:appid} app=\"%{DATA:app}\" appcat=\"%{DATA:appcat}\" apprisk=%{DATA:apprisk} applist=\"%{DATA:applist}\" appact=%{DATA:appact} utmaction=%{DATA:utmaction} countapp=%{DATA:countapp} crscore=%{DATA:crscore} craction=%{DATA:craction}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" action=\"%{DATA:action}\" Threattype=\"%{DATA:Threattype}\" live=%{DATA:live} age=%{DATA:age} channel=%{DATA:channel} rssi=%{DATA:rssi} Frametype=\"%{DATA:Frametype}\" DS=\"%{DATA:DS}\" bssid=\"%{DATA:bssid}\" seq=%{DATA:seq} Encrypt=%{DATA:Encrypt} TAMAC=%{DATA:TAMAC} manuf=\"%{DATA:manuf}\" sndetected=\"%{DATA:sndetected}\" radioiddetected=%{DATA:radioiddetected} msg=\"%{DATA:msg}\" Dur=%{DATA:Dur}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=01040%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" sn=\"FP%{DATA:sn}\" ap=\"%{DATA:ap}\" vap=\"%{DATA:vap}\" ssid=\"%{DATA:ssid}\" user=\"%{WORD:user}\" group=\"%{DATA:group}\" mac=%{DATA:mac} ip=%{DATA:ip} channel=%{DATA:channel} radioband=\"%{DATA:radioband}\" security=\"%{DATA:security}\" action=\"client-%{DATA:action}\" reason=\"%{DATA:reason}\" msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=01040%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" sn=\"%{DATA:sn}\" ap=\"%{DATA:ap}\" vap=\"%{DATA:vap}\" ssid=\"%{DATA:ssid}\" user=\"%{WORD:user}\" group=\"%{DATA:group}\" mac=%{DATA:mac} ip=%{DATA:ip} channel=%{DATA:channel} radioband=\"%{DATA:radioband}\" security=\"%{DATA:security}\" action=\"%{DATA:action}\" reason=\"%{DATA:reason}\" msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" srcssid=\"%{DATA:srcssid}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" group=\"%{DATA:group}\" policyid=%{DATA:policyid} crscore=%{DATA:crscore} craction=%{DATA:craction}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" sessionid=%{DATA:sessionid} action=%{DATA:action} user=\"%{WORD:user}\" policyid=%{DATA:policyid} crscore=%{DATA:crscore} craction=%{DATA:craction}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" sn=\"%{DATA:sn}\" ap=\"%{DATA:ap}\" ip=\"%{DATA:ip}\" radioid=%{DATA:radioid} configcountry=\"%{DATA:configcountry}\" opercountry=\"%{DATA:opercountry}\" cfgtxpower=%{DATA:cfgtxpower} opertxpower=%{DATA:opertxpower} action=\"%{DATA:action}\" msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcname=%{DATA:srcname} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" sessionid=%{DATA:sessionid} action=%{DATA:action} policyid=%{DATA:policyid} crscore=%{DATA:crscore} craction=%{DATA:craction}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=%{WORD:vd} srcip=%{IP:srcip} srcport=%{DATA:srcport} srcintf=\"%{DATA:srcintf}\" srcssid=\"%{DATA:srcssid}\" dstip=%{IP:dstip} dstport=%{DATA:dstport} dstintf=\"%{DATA:dstintf}\" sessionid=%{DATA:sessionid} action=%{DATA:action} policyid=%{DATA:policyid} crscore=%{DATA:crscore} craction=%{DATA:craction}",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" sn=\"%{DATA:sn}\" ap=\"%{DATA:ap}\" approfile=\"%{DATA:approfile}\" ip=%{DATA:ip} meshmode=\"%{DATA:meshmode}\" snmeshparent=\"%{DATA:snmeshparent}\" action=\"%{DATA:action}\" reason=\"%{DATA:reason}\" msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" src=%{DATA:src} dst=%{DATA:dst} policyid=%{DATA:policyid} user=\"%{WORD:user}\" group=\"%{DATA:group}\" ui=\"%{DATA:ui}\" action=%{DATA:action} status=%{DATA:status} reason=\"%{DATA:reason}\" msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" user=\"%{WORD:user}\" ui=\"%{DATA:ui}\" action=%{DATA:action} cfgtid=%{DATA:cfgtid} cfgpath=\"%{DATA:cfgpath}\" cfgobj=\"%{DATA:cfgobj}\" cfgattr=\"%{DATA:cfgattr}\" msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" user=\"%{WORD:user}\" ui=%{DATA:ui} action=%{DATA:action} status=%{DATA:status} duration=%{DATA:duration} reason=%{DATA:reason} msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" user=\"%{WORD:user}\" ui=%{DATA:ui} action=%{DATA:action} status=%{DATA:status} reason=%{DATA:reason} profile=\"%{DATA:profile}\" msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" action=\"%{DATA:action}\" cpu=%{DATA:cpu} mem=%{DATA:mem} totalsession=%{DATA:totalsession} disk=%{DATA:disk} msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" src=%{DATA:src} user=\"%{WORD:user}\" server=\"%{DATA:server}\" action=%{DATA:action} msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" user=\"%{WORD:user}\" ui=%{DATA:ui} field=%{DATA:field} msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" process=\"%{DATA:process}\" reason=\"%{DATA:reason}\" msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" user=\"%{WORD:user}\" ui=%{DATA:ui} msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" action=%{DATA:action} msg=\"%{DATA:msg}\"",
"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} level=%{WORD:level} vd=\"%{WORD:vd}\" logdesc=\"%{DATA:logdesc}\" msg=\"%{DATA:msg}\"",
			#ULTIMO VALIDADOR: DEFAULT
			"<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME:fwhora} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:subtype} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}" ] }
#                       match => { "message" => "<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}" }
#                       match => { "message" => "<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR:fwyear}-%{INT:fwmes}-%{INT:fwdia} time=%{TIME:fwhora} devname=%{DATA:FortiGate} devid=FG300C%{DATA:FortiID} logid=%{DATA:logid}(?:\[%{POSINT:syslog_pid}\])?" }
#LUIS MOD FORTIGATE 300C
#                       match => { "message" => "<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR}-%{MONTHNUM}-%{MONTHDAY} time=%{TIME} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:type} eventtype=%{DATA:type} level=%{WORD:level} vd=%{DATA:info} appid=%{DATA:info} user="%{WORD:user}" group="%{DATA:usergroup}" srcip=%{IP:ipo} srcport=%{POSINT:porto} dstip=%{IP:ipd} dstport=%{POSINT:portd} proto=%{DATA:protocol} service=%{DATA:servicio} sessionid=%{DATA:ssid} applist=%{DATA:apppolicy} appcat=%{DATA:apppolicy} app=%{DATA:app} action=%{DATA:action} hostname=%{DATA:destino} url=%{DATA:url} msg=\"%{DATA:msg}\" apprisk=%{DATA:risk}" }
#                       match => { "message" => "<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:OrigenLog} date=%{YEAR:yearfw}-%{INT:mesfw}-%{INT:diafw} time=%{TIME:horafw} devname=%{DATA:FortiGate} devid=FG300C%{DATA:IDForti} logid=%{DATA:logid} type=%{DATA:type} subtype=%{DATA:type} eventtype=%{DATA:type} level=%{WORD:level} vd="%{WORD:info}" appid=%{DATA:info} user="%{WORD:user}" group="%{DATA:usergroup}" srcip=%{IP:ipo} srcport=%{POSINT:porto} dstip=%{IP:ipd} dstport=%{POSINT:portd} proto=%{DATA:protocol} service=%{DATA:servicio} sessionid=%{DATA:ssid} applist=%{DATA:apppolicy} appcat=%{DATA:apppolicy} app=%{DATA:app} action=%{DATA:action} hostname=%{DATA:destino} url=%{DATA:url} msg=%{DATA:msg} %{DATA:msg} apprisk=%{WORD:risk}" }
#FIN MOD
                        add_field => [ "received_at", "%{@timestamp}" ]
                        add_field => [ "received_from", "%{host}" ]
			add_tag => ["FORTIGATE"]  		 #ETIQUETA
                }
                syslog_pri { }
                date {
                        match => [ "syslog_timestamp", "MMM d HH:mm:ss", "MMM dd HH:mm:ss", "ISO8601" ]
                        timezone => "America/New_York"
                }
                if !("_grokparsefailure" in [tags]) {
                        mutate {
                                replace => [ "host", "%{syslog_hostname}" ]
                                replace => [ "@source_host", "%{syslog_hostname}" ]
                                replace => [ "@message", "%{syslog_message}" ]
                        }
                }
        }
}
# Setting up IPTables firewall parsing
filter {
        if "syslog" in [tags] {
                if "IPTables" in [message] {
                        grok {
                                match => { "message" => "%{IPTABLES}" }
                                patterns_dir => [ "/opt/logstash/patterns" ]
                        }
                        mutate {
                                add_tag => [ "IPTABLES" ]
                        }
                        geoip {
                                source => "src_ip"
                                target => "geoip"
                                add_field => [ "[geoip][coordinates]", "%{[geoip][longitude]}" ]
                                add_field => [ "[geoip][coordinates]", "%{[geoip][latitude]}"  ]
                        }
                        mutate {
                                convert => [ "[geoip][coordinates]", "float" ]
                        }
                }
        }
}
# Setting up IPTables actions
# Setting up HAProxy parsing
# Setting up KeepAliveD parsing
filter {
        if "syslog" in [tags] {
                if [syslog_program] =~ /Keepalived/ {
                        mutate {
                                add_tag => [ "KeepAliveD" ]
                        }
                }
        }
}
# Filtering for SSH logins either failed or successful
filter {
        if "syslog" in [tags] {
                if [syslog_program] == "sshd" {
                        if "Failed password" in [message] {
                                grok {
                                        break_on_match => false
                                        match => [
                                                "message", "invalid user %{DATA:UserName} from %{IP:src_ip}",
                                                "message", "for %{DATA:UserName} from %{IP:src_ip}"
                                        ]
                                }
                                mutate {
                                        add_tag => [ "SSH_Failed_Login" ]
                                }
                        }
                        if "Accepted password" in [message] {
                                grok {
                                        match => [
                                                "message", "for %{DATA:UserName} from %{IP:src_ip}"
                                        ]
                                }
                                mutate {
                                        add_tag => [ "SSH_Successful_Login" ]
                                }
                        }
                        geoip {
                                source => "src_ip"
                                target => "geoip"
                                add_field => [ "[geoip][coordinates]", "%{[geoip][longitude]}" ]
                                add_field => [ "[geoip][coordinates]", "%{[geoip][latitude]}"  ]
                        }
                        mutate {
                                convert => [ "[geoip][coordinates]", "float" ]
                        }
                }
        }
}
# Create @source_host_ip field for all devices for IP Tracking used along with src_ip and dst_ip fields
filter {
        if ![source_host_ip] {
                mutate {
                        add_field => [ "source_host_ip", "%{@source_host}" ]
                }
                dns {
                        resolve => [ "source_host_ip" ]
                        action => "replace"
                }
                mutate {
                        rename => [ "source_host_ip", "@source_host_ip" ]
                }
        }
}
# The below filter section will be used to remove unnecessary fields to keep ES memory cache from filling up with useless data
# The below filter section will be where you would want to comment certain types or tags out if trying to isolate a logging issue
filter {
        if [type] == "syslog" {
                mutate {
                        remove_field => [ "host", "received_at", "received_from", "syslog_hostname", "syslog_message" ]
                }
        }
}
#### All in One install mode ####
# Send output to local elasticsearch instance
# Change to one of the other modes and comment out below if needed
output {
        elasticsearch_http {
                host => "127.0.0.1"
                flush_size => 1
		template_overwrite => true
                manage_template => true
                template => "/opt/logstash/lib/logstash/outputs/elasticsearch/elasticsearch-template.json"
        }
}
#### Multicast discovery mode ####
# Send output to the ES cluster logstash-cluster using a predefined template
# The following settings will be used during the initial setup which will be used for using multicast ES nodes
# When changing to unicast discovery mode you need to comment out the following section and configure the unicast discovery mode in the next section
#output {
#        elasticsearch {
#                cluster => "logstash-cluster"
#                flush_size => 1
#                manage_template => true
#                template => "/opt/logstash/lib/logstash/outputs/elasticsearch/elasticsearch-template.json"
#        }
#}
#### Unicast discovery mode ####
# Send output to the ES cluster logstash-cluster using a predefined template
# The settings below will be used when you change to unicast discovery mode for all ES nodes
# Make sure to comment out the above multicast discovery mode section
#output {
#        elasticsearch {
#                cluster => "logstash-cluster"
#                host => "logstash"
#                port => "9300"
#                protocol => "node"
#                flush_size => "1"
#                manage_template => true
#                template_overwrite => true
#                template => "/opt/logstash/lib/logstash/outputs/elasticsearch/elasticsearch-template.json"
#        }
#}
